<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_191) on Thu Dec 20 19:53:54 CST 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Blocking (ratpack-exec 1.6.0 API)</title>
<meta name="date" content="2018-12-20">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Blocking (ratpack-exec 1.6.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../ratpack/exec/Downstream.html" title="interface in ratpack.exec"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?ratpack/exec/Blocking.html" target="_top">Frames</a></li>
<li><a href="Blocking.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">ratpack.exec</div>
<h2 title="Class Blocking" class="title">Class Blocking</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>ratpack.exec.Blocking</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">Blocking</span>
extends java.lang.Object</pre>
<div class="block">Facilitates working with code that blocks (e.g. synchronous IO)</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../ratpack/exec/Blocking.html#exec-ratpack.func.Block-">exec</a></span>(<a href="../../ratpack/func/Block.html" title="interface in ratpack.func">Block</a>&nbsp;block)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;<a href="../../ratpack/exec/Promise.html" title="interface in ratpack.exec">Promise</a>&lt;T&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../ratpack/exec/Blocking.html#get-ratpack.func.Factory-">get</a></span>(ratpack.func.Factory&lt;T&gt;&nbsp;factory)</code>
<div class="block">Performs a blocking operation on a separate thread, returning a promise for its value.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../ratpack/exec/Blocking.html#on-ratpack.exec.Promise-">on</a></span>(<a href="../../ratpack/exec/Promise.html" title="interface in ratpack.exec">Promise</a>&lt;T&gt;&nbsp;promise)</code>
<div class="block">Blocks execution waiting for this promise to complete and returns the promised value.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static <a href="../../ratpack/exec/Operation.html" title="interface in ratpack.exec">Operation</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../ratpack/exec/Blocking.html#op-ratpack.func.Block-">op</a></span>(<a href="../../ratpack/func/Block.html" title="interface in ratpack.func">Block</a>&nbsp;block)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="get-ratpack.func.Factory-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;<a href="../../ratpack/exec/Promise.html" title="interface in ratpack.exec">Promise</a>&lt;T&gt;&nbsp;get(ratpack.func.Factory&lt;T&gt;&nbsp;factory)</pre>
<div class="block">Performs a blocking operation on a separate thread, returning a promise for its value.
 <p>
 This method should be used to perform blocking IO, or to perform any operation that synchronously waits for something to happen.
 The given factory function will be executed on a thread from a special pool for such operations (i.e. not a thread from the main compute event loop).
 <p>
 The operation should do as little computation as possible.
 It should just perform the blocking operation and immediately return the result.
 Performing computation during the operation will degrade performance.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - the type of value created by the operation</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>factory</code> - the operation that blocks</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a promise for the return value of the given blocking operation</dd>
</dl>
</li>
</ul>
<a name="on-ratpack.exec.Promise-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>on</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;T&nbsp;on(<a href="../../ratpack/exec/Promise.html" title="interface in ratpack.exec">Promise</a>&lt;T&gt;&nbsp;promise)
                throws java.lang.Exception</pre>
<div class="block">Blocks execution waiting for this promise to complete and returns the promised value.
 <p>
 This method allows the use of asynchronous API, by synchronous API.
 This may occur when integrating with other libraries that are not asynchronous.
 The following example simulates using a library that takes a callback that is expected to produce a value synchronously,
 but where the production of the value is actually asynchronous.

 <pre class="java"><code>import ratpack.test.exec.ExecHarness;
 import ratpack.exec.ExecResult;
 import ratpack.exec.Blocking;
 import ratpack.exec.Promise;
 import ratpack.func.Factory;

 import static org.junit.Assert.assertEquals;

 public class Example {
   static &lt;T&gt; T produceSync(Factory&lt;? extends T&gt; factory) throws Exception {
     return factory.create();
   }

   public static void main(String... args) throws Exception {
     ExecResult&lt;String&gt; result = ExecHarness.yieldSingle(e -&gt;
       Blocking.get(() -&gt;
         produceSync(() -&gt;
           Blocking.on(Promise.value("foo")) // block and wait for the promised value
         )
       )
     );

     assertEquals("foo", result.getValue());
   }
 }
 </code></pre>

 <p>
 <b>Important:</b> this method can only be used inside a <a href="../../ratpack/exec/Blocking.html" title="class in ratpack.exec"><code>Blocking</code></a> function.
 That is, it can only be used from a Ratpack managed blocking thread.
 If it is called on a non Ratpack managed blocking thread it will immediately throw an <a href="../../ratpack/exec/ExecutionException.html" title="class in ratpack.exec"><code>ExecutionException</code></a>.
 <p>
 When this method is called, the promise will be subscribed to on a compute thread while the blocking thread waits.
 When the promised value has been produced, and the compute thread segment has completed, the value will be returned
 allowing execution to continue on the blocking thread.
 The following example visualises this flow by capturing the sequence of events via an <a href="../../ratpack/exec/ExecInterceptor.html" title="interface in ratpack.exec"><code>ExecInterceptor</code></a>.

 <pre class="java"><code>import ratpack.test.exec.ExecHarness;
 import ratpack.exec.Blocking;
 import ratpack.exec.Promise;
 import ratpack.exec.ExecResult;
 import ratpack.exec.ExecInterceptor;

 import java.util.List;
 import java.util.ArrayList;
 import java.util.Arrays;

 import static org.junit.Assert.assertEquals;

 public class Example {
   public static void main(String... args) throws Exception {
     List&lt;String&gt; events = new ArrayList&lt;&gt;();

     ExecHarness.yieldSingle(
       r -&gt; r.add(ExecInterceptor.class, (execution, execType, continuation) -&gt; {
         events.add(execType + "-start");
         try {
           continuation.execute();
         } finally {
           events.add(execType + "-stop");
         }
       }),
       e -&gt; Blocking.get(() -&gt; Blocking.on(Promise.value("foo")))
     );

     List&lt;String&gt; actualEvents = Arrays.asList(
       "COMPUTE-start",
       "COMPUTE-stop",
         "BLOCKING-start",
           "COMPUTE-start",
           "COMPUTE-stop",
         "BLOCKING-stop",
       "COMPUTE-start",
       "COMPUTE-stop"
     );

     assertEquals(actualEvents, events);
   }
 }
 </code></pre></div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - the type of value returned by the promise</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>promise</code> - the promise to block on</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the promised value</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../ratpack/exec/ExecutionException.html" title="class in ratpack.exec">ExecutionException</a></code> - if not called on a Ratpack managed blocking thread</dd>
<dd><code>java.lang.Exception</code> - any thrown while producing the value</dd>
</dl>
</li>
</ul>
<a name="op-ratpack.func.Block-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>op</h4>
<pre>public static&nbsp;<a href="../../ratpack/exec/Operation.html" title="interface in ratpack.exec">Operation</a>&nbsp;op(<a href="../../ratpack/func/Block.html" title="interface in ratpack.func">Block</a>&nbsp;block)</pre>
</li>
</ul>
<a name="exec-ratpack.func.Block-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>exec</h4>
<pre>public static&nbsp;void&nbsp;exec(<a href="../../ratpack/func/Block.html" title="interface in ratpack.func">Block</a>&nbsp;block)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../ratpack/exec/Downstream.html" title="interface in ratpack.exec"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?ratpack/exec/Blocking.html" target="_top">Frames</a></li>
<li><a href="Blocking.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
